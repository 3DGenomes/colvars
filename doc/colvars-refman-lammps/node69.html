<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Adaptive Linear Bias/Experiment Directed Simulation</TITLE>
<META NAME="description" CONTENT="Adaptive Linear Bias/Experiment Directed Simulation">
<META NAME="keywords" CONTENT="colvars-refman-lammps">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="colvars-refman-lammps.css">

<LINK REL="next" HREF="node70.html">
<LINK REL="previous" HREF="node68.html">
<LINK REL="up" HREF="node52.html">
<LINK REL="next" HREF="node70.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html1153"
  HREF="node70.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A>
<A NAME="tex2html1147"
  HREF="node52.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A>
<A NAME="tex2html1141"
  HREF="node68.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A>
<A NAME="tex2html1149"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>
<A NAME="tex2html1151"
  HREF="node71.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A>
<BR>
<B> Next:</B> <A NAME="tex2html1154"
  HREF="node70.html">Multidimensional histograms</A>
<B> Up:</B> <A NAME="tex2html1148"
  HREF="node52.html">Biasing and analysis methods</A>
<B> Previous:</B> <A NAME="tex2html1142"
  HREF="node68.html">Linear restraints</A>
 &nbsp; <B>  <A NAME="tex2html1150"
  HREF="node1.html">Contents</A></B>
 &nbsp; <B>  <A NAME="tex2html1152"
  HREF="node71.html">Index</A></B>
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION00085000000000000000"></A>
<A NAME="sec:colvarbias_alb"></A>
<BR>
Adaptive Linear Bias/Experiment Directed Simulation
</H2>

<P>
Experiment directed simulation applies a linear bias with a changing
force constant. Please cite White and Voth [<A
 HREF="node72.html#White2014">19</A>] when
using this feature. As opposed to that reference, the force constant here is scaled
by the <TT>width</TT> corresponding to the biased colvar. In White and
Voth, each force constant is scaled by the colvars set center. The
bias converges to a linear bias, after which it will be the minimal
possible bias. You may also stop the simulation, take the median of
the force constants (ForceConst) found in the colvars trajectory file,
and then apply a linear bias with that constant. All the notes about
units described in sections <A HREF="node68.html#sec:colvarbias_linear">6.4</A>
and <A HREF="node64.html#sec:colvarbias_harmonic">6.3</A> apply here as well. <B>This is not
a valid simulation of any particular statistical ensemble and is only
an optimization algorithm until the bias has converged</B>.

<P>

<UL>
<LI><A NAME="6385"></A>
  <B><BIG CLASS="LARGE"><TT>centers </TT></BIG></B> <SPAN CLASS="MATH"><B><IMG
 WIDTH="13" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img19.png"
 ALT="$ \langle $"></B></SPAN>Collective variable centers<SPAN CLASS="MATH"><B><IMG
 WIDTH="13" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img20.png"
 ALT="$  \rangle$"></B></SPAN>
<BR><B>Context: </B> <TT>alb</TT>
<BR><B>Acceptable values: </B> space-separated list of colvar values
<BR><B>Description: </B> The desired center (equilibrium values) which will be sought during the
      adaptive linear biasing.
    The number of values must be the number of requested colvars.
    Each value is a decimal number if the corresponding colvar returns
    a scalar, a ``<TT>(x, y, z)</TT>'' triplet if it returns a unit
    vector or a vector, and a ``<TT>q0, q1, q2, q3)</TT>'' quadruplet
    if it returns a rotational quaternion.  If a colvar has
    periodicities or symmetries, its closest image to the restraint
    center is considered when calculating the linear potential.
</LI>
<LI><A NAME="6402"></A>
  <B><BIG CLASS="LARGE"><TT>updateFrequency </TT></BIG></B> <SPAN CLASS="MATH"><B><IMG
 WIDTH="13" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img19.png"
 ALT="$ \langle $"></B></SPAN>The duration of updates<SPAN CLASS="MATH"><B><IMG
 WIDTH="13" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img20.png"
 ALT="$  \rangle$"></B></SPAN>
<BR><B>Context: </B> <TT>alb</TT>
<BR><B>Acceptable values: </B> An integer
<BR><B>Description: </B> This is, <SPAN CLASS="MATH"><B><IMG
 WIDTH="17" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img5.png"
 ALT="$ N$"></B></SPAN>, the number of simulation steps to use for each update to the bias.
      This determines how long the system requires to equilibrate
      after a change in force constant (<SPAN CLASS="MATH"><B><IMG
 WIDTH="34" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img195.png"
 ALT="$ N/2$"></B></SPAN>), how long statistics
      are collected for an iteration (<SPAN CLASS="MATH"><B><IMG
 WIDTH="34" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img195.png"
 ALT="$ N/2$"></B></SPAN>), and how quickly energy is
      added to the system (at most, <SPAN CLASS="MATH"><B><IMG
 WIDTH="45" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img196.png"
 ALT="$ A/2N$"></B></SPAN>, where <SPAN CLASS="MATH"><B><IMG
 WIDTH="15" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img197.png"
 ALT="$ A$"></B></SPAN> is the <TT>forceRange</TT>). Until the force
      constant has converged, the method as described is an
      optimization procedure and not an integration of a particular
      statistical ensemble. It is important that each step should be
      uncorrelated from the last so that iterations are independent.
      Therefore, <SPAN CLASS="MATH"><B><IMG
 WIDTH="17" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img5.png"
 ALT="$ N$"></B></SPAN> should be at least twice the autocorrelation time
      of the collective variable. The system should also be able to
      dissipate energy as fast as <SPAN CLASS="MATH"><B><IMG
 WIDTH="34" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img195.png"
 ALT="$ N/2$"></B></SPAN>, which can be done by adjusting
      thermostat parameters. Practically, <SPAN CLASS="MATH"><B><IMG
 WIDTH="17" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img5.png"
 ALT="$ N$"></B></SPAN> has been tested successfully at
      significantly shorter than the autocorrelation time of the
      collective variables being biased and still converge correctly.

<P>
</LI>
<LI><A NAME="6419"></A>
  <B><BIG CLASS="LARGE"><TT>forceRange </TT></BIG></B> <SPAN CLASS="MATH"><B><IMG
 WIDTH="13" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img19.png"
 ALT="$ \langle $"></B></SPAN>The expected range of the force constant in units of energy<SPAN CLASS="MATH"><B><IMG
 WIDTH="13" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img20.png"
 ALT="$  \rangle$"></B></SPAN>
<BR><B>Context: </B> <TT>alb</TT>
<BR><B>Acceptable values: </B> A space-separated list of decimal numbers
<BR><B>Default value: </B> 3 <SPAN CLASS="MATH"><B><IMG
 WIDTH="31" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img198.png"
 ALT="$ k_b T$"></B></SPAN>
<BR><B>Description: </B> This is largest magnitude of the force constant which one expects. If this parameter is
      too low, the simulation will not converge. If it is too high the
      simulation will waste time exploring values that are too
      large. A value of 3 <SPAN CLASS="MATH"><B><IMG
 WIDTH="31" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img198.png"
 ALT="$ k_b T$"></B></SPAN> has worked well in the systems presented
      as a first choice. This parameter is dynamically adjusted over
      the course of a simulation. The benefit is that a bad guess for
      the forceRange can be corrected. However, this can lead to
      large amounts of energy being added over time to the system. To
      prevent this dynamic update, add <TT>hardForceRange yes</TT>
      as a parameter
</LI>
<LI><A NAME="6436"></A>
  <B><BIG CLASS="LARGE"><TT>rateMax </TT></BIG></B> <SPAN CLASS="MATH"><B><IMG
 WIDTH="13" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img19.png"
 ALT="$ \langle $"></B></SPAN>The maximum rate of change of force constant<SPAN CLASS="MATH"><B><IMG
 WIDTH="13" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img20.png"
 ALT="$  \rangle$"></B></SPAN>
<BR><B>Context: </B> <TT>alb</TT>
<BR><B>Acceptable values: </B> A list of space-separated real numbers
<BR><B>Description: </B> This optional parameter controls
      how much energy is added to the system from this bias.  Tuning
      this separately from the <TT>updateFrequency</TT>
      and <TT>forceRange</TT> can allow for large bias changes but
      with a low <TT>rateMax</TT> prevents large energy changes that
      can lead to instability in the simulation.

<P>
</LI>
</UL>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html1153"
  HREF="node70.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A>
<A NAME="tex2html1147"
  HREF="node52.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A>
<A NAME="tex2html1141"
  HREF="node68.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A>
<A NAME="tex2html1149"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>
<A NAME="tex2html1151"
  HREF="node71.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A>
<BR>
<B> Next:</B> <A NAME="tex2html1154"
  HREF="node70.html">Multidimensional histograms</A>
<B> Up:</B> <A NAME="tex2html1148"
  HREF="node52.html">Biasing and analysis methods</A>
<B> Previous:</B> <A NAME="tex2html1142"
  HREF="node68.html">Linear restraints</A>
 &nbsp; <B>  <A NAME="tex2html1150"
  HREF="node1.html">Contents</A></B>
 &nbsp; <B>  <A NAME="tex2html1152"
  HREF="node71.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Jérôme Hénin
2015-03-03
</ADDRESS>
</BODY>
</HTML>
