<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Treatment of periodic boundary conditions.</TITLE>
<META NAME="description" CONTENT="Treatment of periodic boundary conditions.">
<META NAME="keywords" CONTENT="colvars-refman-lammps">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="colvars-refman-lammps.css">

<LINK REL="next" HREF="node20.html">
<LINK REL="previous" HREF="node18.html">
<LINK REL="up" HREF="node16.html">
<LINK REL="next" HREF="node20.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html385"
  HREF="node20.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html379"
  HREF="node16.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html373"
  HREF="node18.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html381"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html383"
  HREF="node32.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html386"
  HREF="node20.html">Computational cost of colvars</A>
<B> Up:</B> <A NAME="tex2html380"
  HREF="node16.html">Selecting atoms for colvars:</A>
<B> Previous:</B> <A NAME="tex2html374"
  HREF="node18.html">Moving frame of reference.</A>
 &nbsp; <B>  <A NAME="tex2html382"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html384"
  HREF="node32.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION00063000000000000000"></A>
<A NAME="sec:colvar_atom_groups_wrapping"></A>
<BR>
Treatment of periodic boundary conditions.
</H2>

<P>
In simulations with periodic boundary conditions, many of the implemented colvar components rely on the fact that each position within a group of atoms is at the nearest periodic image from the center of geometry of the group itself.
However, due to the internal wrapping of individual atomic positions done by LAMMPS, this assumption is inaccurate if groups lies at one of the unit cell's boundaries.
For this reason, within the colvars module coordinates are unwrapped by default to avoid discontinuities due to coordinate wrapping (see <TT>unwrap</TT> keyword in <A HREF="#sec:colvars_lammps"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>).
The user should determine whether maintaining the default value of <TT>unwrap</TT>, depending on the specifics of each system.
In general, internal coordinate wrapping by LAMMPS does not affect the calculation of colvars if each atom group satisfies one or more of the following:

<P>
<DL COMPACT>
<DT><SPAN  CLASS="textit">i)</SPAN></DT>
<DD>it is composed by only one atom;
  
</DD>
<DT><SPAN  CLASS="textit">ii)</SPAN></DT>
<DD>it is used by a colvar component which does not make use of its center of geometry, but only of pairwise distances (<TT>distanceInv</TT>, <TT>coordNum</TT>, <TT>hBond</TT>, <TT>alpha</TT>, <TT>dihedralPC</TT>);
  
</DD>
<DT><SPAN  CLASS="textit">iii)</SPAN></DT>
<DD>it is used by a colvar component that ignores the ill-defined Cartesian components of its center of mass (such as the <SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img44.png"
 ALT="$ x$"></SPAN> and <SPAN CLASS="MATH"><IMG
 WIDTH="12" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img45.png"
 ALT="$ y$"></SPAN> components of a membrane's center of mass modeled with <TT>distanceZ</TT>).
</DD>
</DL>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html385"
  HREF="node20.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html379"
  HREF="node16.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html373"
  HREF="node18.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html381"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html383"
  HREF="node32.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html386"
  HREF="node20.html">Computational cost of colvars</A>
<B> Up:</B> <A NAME="tex2html380"
  HREF="node16.html">Selecting atoms for colvars:</A>
<B> Previous:</B> <A NAME="tex2html374"
  HREF="node18.html">Moving frame of reference.</A>
 &nbsp; <B>  <A NAME="tex2html382"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html384"
  HREF="node32.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Jérôme Hénin
2015-03-03
</ADDRESS>
</BODY>
</HTML>
